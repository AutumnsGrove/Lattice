<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#16a34a" />
    <!-- Prevent Dark Reader from interfering with Grove's native dark mode -->
    <meta name="darkreader-lock" />
    <meta name="csrf-token" content="%sveltekit.locals.csrfToken%" />

    <!-- Resource Hints: Preconnect to critical origins -->
    <!-- Saves ~100-300ms by establishing connection before font requests -->
    <link rel="preconnect" href="https://cdn.grove.place" crossorigin />
    <link rel="dns-prefetch" href="https://cdn.grove.place" />

    <!-- Preload critical font (Lexend is the default across all Grove sites) -->
    <link
      rel="preload"
      href="https://cdn.grove.place/fonts/Lexend-Regular.ttf"
      as="font"
      type="font/ttf"
      crossorigin
    />

    <!-- Favicons -->
    <link
      rel="icon"
      type="image/svg+xml"
      href="%sveltekit.assets%/favicon.svg"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="%sveltekit.assets%/favicon-32x32.png"
    />

    <!-- Apple Touch Icon (iOS home screen, iMessage previews) -->
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="%sveltekit.assets%/apple-touch-icon.png"
    />

    <!-- Safari Pinned Tab -->
    <link
      rel="mask-icon"
      href="%sveltekit.assets%/safari-pinned-tab.svg"
      color="#16a34a"
    />

    <!-- PWA Manifest -->
    <link rel="manifest" href="%sveltekit.assets%/site.webmanifest" />

    <!-- Windows -->
    <meta name="msapplication-TileColor" content="#0f172a" />
    <meta name="msapplication-config" content="none" />
    <script>
      // Prevent flash of incorrect theme by setting theme before hydration
      (function () {
        const savedTheme = localStorage.getItem("theme");
        let isDark = false;

        if (savedTheme === "dark") {
          isDark = true;
        } else if (savedTheme === "light") {
          isDark = false;
        } else {
          // Respect system preference, default to light if no preference
          isDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
        }

        if (isDark) {
          document.documentElement.classList.add("dark");
        }
      })();
    </script>
    %sveltekit.head%
  </head>
  <body data-sveltekit-preload-data="hover">
    <div style="display: contents">%sveltekit.body%</div>
  </body>
</html>
