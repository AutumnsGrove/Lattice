# GroveEngine - Cloudflare Pages Configuration
# Each Grove site runs as its own Cloudflare Pages deployment
#
# SETUP INSTRUCTIONS:
# 1. Replace "your-site-name" with your actual site name
# 2. Create D1 database: npx wrangler d1 create your-site-posts
# 3. Create R2 bucket: npx wrangler r2 bucket create your-site-images
# 4. Create KV namespace: npx wrangler kv:namespace create CACHE
# 5. Update the IDs below with actual values from creation output
# 6. Set secrets: npx wrangler secret put SESSION_SECRET (etc.)

name = "your-site-name"
compatibility_date = "2025-01-01"

# Cloudflare Pages Functions output directory
pages_build_output_dir = ".svelte-kit/cloudflare"

# =============================================================================
# KV Namespace - For caching and rate limiting
# =============================================================================
# Create with: npx wrangler kv:namespace create CACHE
[[kv_namespaces]]
binding = "CACHE_KV"
id = "your-kv-namespace-id"

# =============================================================================
# R2 Bucket - For image and media storage
# =============================================================================
# Create with: npx wrangler r2 bucket create your-site-images
[[r2_buckets]]
binding = "IMAGES"
bucket_name = "your-site-images"

# =============================================================================
# D1 Database - For posts, pages, settings, and auth
# =============================================================================
# Create with: npx wrangler d1 create your-site-posts
# Run migrations: npx wrangler d1 execute your-site-posts --file=migrations/001_magic_codes.sql
[[d1_databases]]
binding = "POSTS_DB"
database_name = "your-site-posts"
database_id = "your-database-id"

# =============================================================================
# Environment Variables (non-sensitive)
# =============================================================================
[vars]
CACHE_TTL_SECONDS = "3600"

# =============================================================================
# Secrets (set via CLI, not in this file!)
# =============================================================================
# Required secrets - set with: npx wrangler secret put SECRET_NAME
#
# SESSION_SECRET     - Secret for signing JWT tokens (32+ random chars)
#                      Generate: openssl rand -hex 32
#
# ALLOWED_ADMIN_EMAILS - Comma-separated list of admin emails
#                        Example: "admin@example.com,owner@example.com"
#
# RESEND_API_KEY     - API key for Resend email service (magic codes)
#                      Get from: https://resend.com
#
# =============================================================================
# Stripe Secrets (for Shop & Billing)
# =============================================================================
# STRIPE_SECRET_KEY  - Stripe secret key (sk_live_xxx or sk_test_xxx)
#                      Get from: https://dashboard.stripe.com/apikeys
#
# STRIPE_PUBLISHABLE_KEY - Stripe publishable key (pk_live_xxx or pk_test_xxx)
#                          Used in frontend for Stripe.js
#
# STRIPE_WEBHOOK_SECRET - Webhook signing secret (whsec_xxx)
#                         Get from: https://dashboard.stripe.com/webhooks
#
# STRIPE_CONNECT_ENABLED - Set to "true" to enable marketplace mode
#
# PLATFORM_FEE_PERCENT - Platform fee percentage for Connect (default: 5)
#
# =============================================================================
# Stripe Price IDs (for Platform Billing)
# =============================================================================
# Create these prices in Stripe Dashboard, then set:
#
# STRIPE_PRICE_STARTER      - Price ID for Starter plan ($12/mo)
# STRIPE_PRICE_PROFESSIONAL - Price ID for Professional plan ($49/mo)
# STRIPE_PRICE_BUSINESS     - Price ID for Business plan ($199/mo)

# =============================================================================
# Cloudflare Pages Notes
# =============================================================================
# - Cron triggers are NOT supported in Pages mode
# - Use Cloudflare Workers for scheduled tasks if needed
# - Assets are handled automatically by Pages
# - Custom domains configured in Cloudflare Dashboard
