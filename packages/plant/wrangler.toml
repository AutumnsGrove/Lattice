name = "grove-plant"
compatibility_date = "2025-01-01"
compatibility_flags = ["nodejs_compat"]
pages_build_output_dir = ".svelte-kit/cloudflare"

# Environment variables
[vars]
# Turnstile (Shade) - human verification
TURNSTILE_SITE_KEY = "0x4AAAAAACI9p49O_VFDy3WA"
ZEPHYR_URL = "https://grove-zephyr.m7jv4v7npb.workers.dev"

# Signup gate - set to "true" when payment processing is ready
# This prevents OAuth flow from proceeding until Stripe is configured
SIGNUPS_ENABLED = "true"

# D1 Database binding (same as landing/engine - shared database)
[[d1_databases]]
binding = "DB"
database_name = "grove-engine-db"
database_id = "a6394da2-b7a6-48ce-b7fe-b1eb3e730e68"

# GroveAuth Service Binding (Heartwood - fast session validation)
[[services]]
binding = "AUTH"
service = "groveauth"

# Zephyr Service Binding (email gateway - direct internal routing)
[[services]]
binding = "ZEPHYR"
service = "grove-zephyr"

# KV Namespace - For rate limiting (email verification, etc.)
# Create with: npx wrangler kv:namespace create KV
# Then add the ID below
[[kv_namespaces]]
binding = "KV"
id = "3d3c7bcadf2a49d2ab46aa507d437f2f"

# Secrets (configured in Cloudflare Dashboard - Pages > Settings > Bindings):
# - GROVEAUTH_URL = https://login.grove.place
# - GROVEAUTH_CLIENT_ID = grove-plant
# - GROVEAUTH_CLIENT_SECRET = (secret)
# - STRIPE_SECRET_KEY = sk_xxx
# - STRIPE_PUBLISHABLE_KEY = pk_xxx
# - STRIPE_WEBHOOK_SECRET = whsec_xxx
# - RESEND_API_KEY = re_xxx
# - TURNSTILE_SECRET_KEY = Cloudflare Turnstile secret (Shade)
#
# NOTE: D1 bindings are read from this file by wrangler pages deploy.
# For secrets/env vars, configure them in Cloudflare Dashboard since
# wrangler pages deploy doesn't support --var flags.
