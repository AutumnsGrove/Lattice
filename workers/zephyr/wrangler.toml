name = "grove-zephyr"
main = "src/index.ts"
compatibility_date = "2025-12-01"

# D1 Database for logs and rate limiting
[[d1_databases]]
binding = "DB"
database_name = "zephyr-logs"
database_id = "a7038f4d-4850-428c-b816-f2636668852d"

# Service binding for Worker-to-Worker communication (no public URL needed)
[[services]]
binding = "EMAIL_RENDER"
service = "grove-email-render"

# Environment variables
[vars]
EMAIL_RENDER_URL = "https://grove-email-render.m7jv4v7npb.workers.dev"
DEFAULT_FROM_EMAIL = "autumn@grove.place"
DEFAULT_FROM_NAME = "Autumn"

[env.production.vars]
ENVIRONMENT = "production"

[env.staging.vars]
ENVIRONMENT = "staging"

# Secrets (set via wrangler secret put)
# RESEND_API_KEY - Resend API key for sending emails
# ZEPHYR_API_KEY - API key for authenticating requests to this service
# BLUESKY_HANDLE - Bluesky handle (e.g. autumn.bsky.social)
# BLUESKY_APP_PASSWORD - Bluesky app password for social posting
